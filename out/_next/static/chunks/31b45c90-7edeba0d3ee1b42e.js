"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{5400:function(e,t,s){s.d(t,{BI:function(){return Re},GL:function(){return Ne},V0:function(){return Ce},Yk:function(){return g},h2:function(){return Oe},ox:function(){return Ae},yS:function(){return Y}});var i=s(5619);const o="data-tabster",r="data-tabster-dummy",n="tabster:deloser",l="tabster:modalizer:active",a="tabster:modalizer:inactive",u="tabster:modalizer:beforefocusout",d="tabster:mover",c="tabster:focusin",h="tabster:focusout",_={Any:0,Accessible:1,Focusable:2},m={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4},f={Invisible:0,PartiallyVisible:1,Visible:2},v={Both:0,Vertical:1,Horizontal:2,Grid:3},b={Unlimited:0,Limited:1,LimitedTrapFocus:2},p={Auto:0,Inside:1,Outside:2};var g=Object.freeze({__proto__:null,TabsterAttributeName:o,TabsterDummyInputAttributeName:r,DeloserEventName:n,ModalizerActiveEventName:l,ModalizerInactiveEventName:a,ModalizerFocusInEventName:"tabster:modalizer:focusin",ModalizerFocusOutEventName:"tabster:modalizer:focusout",ModalizerBeforeFocusOutEventName:u,MoverEventName:d,FocusInEventName:c,FocusOutEventName:h,ObservedElementAccesibilities:_,RestoreFocusOrders:m,Visibilities:f,MoverDirections:v,GroupperTabbabilities:b,SysDummyInputsPositions:p});function T(e,t){var s;return null===(s=e.storageEntry(t))||void 0===s?void 0:s.tabster}function E(e,t,s){var i,r;const n=s||e._noop?void 0:t.getAttribute(o);let l,a=e.storageEntry(t);if(n){if(n===(null===(i=null===a||void 0===a?void 0:a.attr)||void 0===i?void 0:i.string))return;try{const e=JSON.parse(n);if("object"!==typeof e)throw new Error(`Value is not a JSON object, got '${n}'.`);l={string:n,object:e}}catch(h){0}}else if(!a)return;a||(a=e.storageEntry(t,!0)),a.tabster||(a.tabster={});const u=a.tabster||{},d=(null===(r=a.attr)||void 0===r?void 0:r.object)||{},c=(null===l||void 0===l?void 0:l.object)||{};for(const o of Object.keys(d))if(!c[o]){if("root"===o){const t=u[o];t&&e.root.onRoot(t,!0)}switch(o){case"deloser":case"root":case"groupper":case"modalizer":case"mover":const s=u[o];s&&(s.dispose(),delete u[o]);break;case"observed":delete u[o],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete u[o]}}for(const o of Object.keys(c)){const s=c.sys;switch(o){case"deloser":u.deloser?u.deloser.setProps(c.deloser):e.deloser&&(u.deloser=e.deloser.createDeloser(t,c.deloser));break;case"root":u.root?u.root.setProps(c.root):u.root=e.root.createRoot(t,c.root,s),e.root.onRoot(u.root);break;case"modalizer":u.modalizer?u.modalizer.setProps(c.modalizer):e.modalizer&&(u.modalizer=e.modalizer.createModalizer(t,c.modalizer,s));break;case"focusable":u.focusable=c.focusable;break;case"groupper":u.groupper?u.groupper.setProps(c.groupper):e.groupper&&(u.groupper=e.groupper.createGroupper(t,c.groupper,s));break;case"mover":u.mover?u.mover.setProps(c.mover):e.mover&&(u.mover=e.mover.createMover(t,c.mover,s));break;case"observed":e.observedElement&&(u.observed=c.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":u.uncontrolled=c.uncontrolled;break;case"outline":e.outline&&(u.outline=c.outline);break;case"sys":u.sys=c.sys;break;default:console.error(`Unknown key '${o}' in data-tabster attribute value.`)}}l?a.attr=l:(0===Object.keys(u).length&&(delete a.tabster,delete a.attr),e.storageEntry(t,!1))}let y;"undefined"!==typeof DOMRect&&DOMRect;let F=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),y=!1}catch(ze){y=!0}function w(e){const t=e();let s=t.__tabsterInstanceContext;return s||(s={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=s),s}class D{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&z(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class I{constructor(e,t,s){const i=w(e);let o;i.WeakRef?o=new i.WeakRef(t):(o=new D(t),i.fakeWeakRefs.push(o)),this._ref=o,this._data=s}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function k(e,t){const s=w(e);s.fakeWeakRefs=s.fakeWeakRefs.filter((e=>!D.cleanup(e,t)))}function A(e){const t=w(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout((()=>{t.fakeWeakRefsTimer=void 0,k(e),A(e)}),12e4))}function O(e,t,s){if(t.nodeType!==Node.ELEMENT_NODE)return;const i=y?s:{acceptNode:s};return e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,i,!1)}function R(e){return!!e.__shouldIgnoreFocus}function C(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let i=0;i<t.length;i++)t[i]=4294967295*Math.random();const s=[];for(let i=0;i<t.length;i++)s.push(t[i].toString(36));return s.push("|"),s.push((++F).toString(36)),s.push("|"),s.push(Date.now().toString(36)),s.join("")}function N(e,t){const s=w(e);let i=t.__tabsterElementUID;return i||(i=t.__tabsterElementUID=C(e())),!s.elementByUId[i]&&z(t.ownerDocument,t)&&(s.elementByUId[i]=new I(e,t)),i}function x(e,t){const s=w(e);for(const i of Object.keys(s.elementByUId)){const e=s.elementByUId[i],o=e&&e.get();o&&t&&!t.contains(o)||delete s.elementByUId[i]}}function z(e,t){var s;return!!(null===(s=null===e||void 0===e?void 0:e.body)||void 0===s?void 0:s.contains(t))}function M(e,t){const s=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return s&&s.call(e,t)}function W(e){const t=w(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}let P=0;class L{constructor(e,t,s){const i=e.getWindow;this._tabster=e,this._element=new I(i,t),this._props={...s},this.id="i"+ ++P}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class U{constructor(e,t,s,i){var o;this._focusIn=e=>{const t=this.input;if(this.onFocusIn&&t){const s=K.getLastPhantomFrom()||e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,s),s)}},this._focusOut=e=>{this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const s=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,s),s)}};const n=e(),l=n.document.createElement("i");l.tabIndex=0,l.setAttribute("role","none"),l.setAttribute(r,""),l.setAttribute("aria-hidden","true");const a=l.style;a.position="fixed",a.width=a.height="1px",a.opacity="0.001",a.zIndex="-1",a.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(l),this.input=l,this.isFirst=s.isFirst,this.isOutside=t,this._isPhantom=null!==(o=s.isPhantom)&&void 0!==o&&o,l.addEventListener("focusin",this._focusIn),l.addEventListener("focusout",this._focusOut),l.__tabsterDummyContainer=i,this._isPhantom&&(this._disposeTimer=n.setTimeout((()=>{delete this._disposeTimer,this.dispose()}),0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(n.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=t.parentElement)||void 0===e||e.removeChild(t))}setTopLeft(e,t){var s;const i=null===(s=this.input)||void 0===s?void 0:s.style;i&&(i.top=`${e}px`,i.left=`${t}px`)}_isBackward(e,t,s){return e&&!s?!this.isFirst:!!(s&&t.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_FOLLOWING)}}const S=1,V=2,B=4;class K{constructor(e,t,s,i,o,r){this._element=t,this._instance=new G(e,t,this,s,i,o,r),this.moveOut=e=>{var t;null===(t=this._instance)||void 0===t||t.moveOut(e)},this.moveOutWithDefaultAction=e=>{var t;null===(t=this._instance)||void 0===t||t.moveOutWithDefaultAction(e)}}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static getLastPhantomFrom(){const e=K._lastPhantomFrom;return delete K._lastPhantomFrom,e}static moveWithPhantomDummy(e,t,s,o){const r=new U(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(r){const n=t.parentElement;if(n){let l=s&&!o||!s&&o?t.nextElementSibling:t;if(l)if(o){const e=l.previousElementSibling;e&&e.__tabsterDummyContainer&&(l=e)}else l.__tabsterDummyContainer&&(l=l.nextElementSibling);n.insertBefore(r,l),K._lastPhantomFrom=t,e.getWindow().setTimeout((()=>{delete K._lastPhantomFrom}),0),(0,i.ev)(r)}}}}class j{constructor(e){this._offsetsQueue=[],this._changedParents=new WeakSet,this._dummies=new Map,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout((()=>{delete this._updateDummyInputsTimer;for(const[e,t]of this._dummies){const s=e.parentElement;s&&!this._changedParents.has(s)||t()}this._changedParents=new WeakSet}),100)))},this._win=e}add(e,t){this._dummies.set(e,t),this.domChanged=this._domChanged}remove(e){const t=this._dummies;t.delete(e),0===t.size&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._offsetsTimer&&(null===t||void 0===t||t.clearTimeout(this._offsetsTimer),delete this._offsetsTimer),this._updateDummyInputsTimer&&(null===t||void 0===t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummies.clear(),delete this._win}updateOffsets(e){var t;this._offsetsQueue.push(e),this._offsetsTimer||(this._offsetsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout((()=>{delete this._offsetsTimer,this._offsetsQueue.forEach((e=>e())),this._offsetsQueue=[]}),100))}}class G{constructor(e,t,s,o,r,n,l){this._wrappers=[],this._isOutside=!1,this._transformElements=[],this._onFocusIn=(e,t,s)=>{this._onFocus(!0,e,t,s)},this._onFocusOut=(e,t,s)=>{this._onFocus(!1,e,t,s)},this.moveOut=e=>{var t;const s=this._firstDummy,o=this._lastDummy;if(s&&o){const r=s.input,n=o.input,l=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&n&&l){let t;e?(r.tabIndex=0,t=r):(n.tabIndex=0,t=n),t&&(0,i.ev)(t)}}},this.moveOutWithDefaultAction=e=>{var t;const s=this._firstDummy,o=this._lastDummy;if(s&&o){const r=s.input,n=o.input,l=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&n&&l){let t;e?!s.isOutside&&this._tabster.focusable.isFocusable(l,!0,!0,!0)?t=l:(s.useDefaultAction=!0,r.tabIndex=0,t=r):(o.useDefaultAction=!0,n.tabIndex=0,t=n),t&&(0,i.ev)(t)}}},this.setTabbable=(e,t)=>{var s,i;for(const r of this._wrappers)if(r.manager===e){r.tabbable=t;break}const o=this._getCurrent();if(o){const e=o.tabbable?0:-1;let t=null===(s=this._firstDummy)||void 0===s?void 0:s.input;t&&(t.tabIndex=e),t=null===(i=this._lastDummy)||void 0===i?void 0:i.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout((()=>{var e,t,s;delete this._addTimer;const i=null===(e=this._element)||void 0===e?void 0:e.get(),o=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(s=this._lastDummy)||void 0===s?void 0:s.input;if(i&&o&&r){if(this._isOutside){const e=i.parentElement;if(e){const t=i.nextElementSibling;t!==r&&e.insertBefore(r,t),i.previousElementSibling!==o&&e.insertBefore(o,i)}}else{i.lastElementChild!==r&&i.appendChild(r);const e=i.firstElementChild;e&&e!==o&&i.insertBefore(o,e)}0,this._addTransformOffsets()}}),0))},this._addTransformOffsets=()=>{const e=this._getWindow();this._scrollTimer&&e.clearTimeout(this._scrollTimer),this._scrollTimer=e.setTimeout((()=>{delete this._scrollTimer,this._tabster._dummyObserver.updateOffsets(this._reallyAddTransformOffsets)}),100)},this._reallyAddTransformOffsets=()=>{var e,t,s,i;const o=(null===(e=this._firstDummy)||void 0===e?void 0:e.input)||(null===(t=this._lastDummy)||void 0===t?void 0:t.input),r=this._transformElements,n=[],l=new WeakMap,a=new WeakMap;let u=0,d=0;for(const h of r)l.set(h,h);const c=this._getWindow();for(let h=o;h;h=h.parentElement){const e=c.getComputedStyle(h).transform;if(e&&"none"!==e){let e=l.get(h);e||(e=h,e.addEventListener("scroll",this._addTransformOffsets)),n.push(e),a.set(e,e),u+=e.scrollTop,d+=e.scrollLeft}}for(const h of r)a.get(h)||h.removeEventListener("scroll",this._addTransformOffsets);this._transformElements=n,null===(s=this._firstDummy)||void 0===s||s.setTopLeft(u,d),null===(i=this._lastDummy)||void 0===i||i.setTopLeft(u,d)};const a=t.get();if(!a)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=l;const u=a.__tabsterDummy;if((u||this)._wrappers.push({manager:s,priority:o,tabbable:!0}),u)return u;a.__tabsterDummy=this;const d=null===r||void 0===r?void 0:r.dummyInputsPosition,c=a.tagName;this._isOutside=d?d===p.Outside:(n||"UL"===c||"OL"===c||"TABLE"===c)&&!("LI"===c||"TD"===c||"TH"===c),this._firstDummy=new U(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new U(this._getWindow,this._isOutside,{isFirst:!1},t);const h=this._firstDummy.input;h&&e._dummyObserver.add(h,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var s,i,o,r;if(0===(this._wrappers=this._wrappers.filter((s=>s.manager!==e&&!t))).length){delete(null===(s=this._element)||void 0===s?void 0:s.get()).__tabsterDummy;for(const s of this._transformElements)s.removeEventListener("scroll",this._addTransformOffsets);this._transformElements=[];const e=this._getWindow();this._scrollTimer&&(e.clearTimeout(this._scrollTimer),delete this._scrollTimer),this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(i=this._firstDummy)||void 0===i?void 0:i.input;t&&this._tabster._dummyObserver.remove(t),null===(o=this._firstDummy)||void 0===o||o.dispose(),null===(r=this._lastDummy)||void 0===r||r.dispose()}}_onFocus(e,t,s,i){var o;const r=this._getCurrent();!r||t.useDefaultAction&&!this._callForDefaultAction||null===(o=r.manager.getHandler(e))||void 0===o||o(t,s,i)}_getCurrent(){return this._wrappers.sort(((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority)),this._wrappers[0]}}function H(e){let t=null;for(let s=e.lastElementChild;s;s=s.lastElementChild)t=s;return t||void 0}function J(e,t){let s=e,i=null;for(;s&&!i;)i=t?s.previousElementSibling:s.nextElementSibling,s=s.parentElement;return i||void 0}function $(e,t,s){const i=document.createEvent("HTMLEvents");return i.initEvent(t,!0,!0),i.details=s,e.dispatchEvent(i),!i.defaultPrevented}function Q(e,t,s,i){const o=e.storageEntry(t,!0);let r=!1;if(!o.aug){if(void 0===i)return r;o.aug={}}if(void 0===i){if(s in o.aug){const e=o.aug[s];delete o.aug[s],null===e?t.removeAttribute(s):t.setAttribute(s,e),r=!0}}else{let e;s in o.aug||(e=t.getAttribute(s)),void 0!==e&&e!==i&&(o.aug[s]=e,null===i?t.removeAttribute(s):t.setAttribute(s,i),r=!0)}return void 0===i&&0===Object.keys(o.aug).length&&(delete o.aug,e.storageEntry(t,!1)),r}function Y(e,t){const s=JSON.stringify(e);return!0===t?s:{[o]:s}}function q(e,t,s){let i;if(s){const t=e.getAttribute(o);if(t)try{i=JSON.parse(t)}catch(ze){0}}i||(i={}),function(e,t){for(const s of Object.keys(t)){const i=t[s];i?e[s]=i:delete e[s]}}(i,t),Object.keys(i).length>0?e.setAttribute(o,Y(i,!0)):e.removeAttribute(o)}class X extends K{constructor(e,t,s,o){super(e,t,S,o,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1,!0);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const s=this._element.get();if(s){this._setFocused(!0,!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:s,ignoreAccessibility:!0});if(t)return void(0,i.ev)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=s}}class Z extends L{constructor(e,t,s,i,o){super(e,t,i),this._isFocused=!1,this._setFocused=(e,t)=>{if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const s=this._element.get();s&&(e?(this._isFocused=!0,$(this._tabster.root.eventTarget,"focus",{element:s,fromAdjacent:t})):this._setFocusedTimer=this._tabster.getWindow().setTimeout((()=>{delete this._setFocusedTimer,this._isFocused=!1,$(this._tabster.root.eventTarget,"blur",{element:s,fromAdjacent:t})}),0))},this._onFocus=e=>{var t;const s=this._tabster.getWindow();if(this._setTabbableTimer&&(s.clearTimeout(this._setTabbableTimer),delete this._setTabbableTimer),e){const s=ee.getTabsterContext(this._tabster,e);if(s&&this._setFocused(s.root.getElement()===this._element.get()),!s||s.uncontrolled||this._tabster.rootDummyInputs)return void(null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1))}else this._setFocused(!1);this._setTabbableTimer=s.setTimeout((()=>{var e;delete this._setTabbableTimer,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0)}),0)},this._onDispose=s;const r=e.getWindow;this.uid=N(r,t),this._sys=o,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs(),e.focusedElement.subscribe(this._onFocus),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new X(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow();this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._setTabbableTimer&&(t.clearTimeout(this._setTabbableTimer),delete this._setTabbableTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e){const t=this._dummyManager;if(t)t.moveOutWithDefaultAction(e);else{const t=this.getElement();t&&X.moveWithPhantomDummy(this._tabster,t,!0,e)}}_add(){0}_remove(){0}}class ee{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._init=()=>{this._initTimer=void 0,this._autoRoot&&this._autoRootCreate()},this._autoRootCreate=()=>{var e;if(this._initTimer)return;const t=this._win().document,s=t.body;if(s){this._autoRootUnwait(t);const i=this._autoRoot;if(i)return q(s,{root:i},!0),E(this._tabster,s),null===(e=T(this._tabster,s))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._autoRoot=t,this.eventTarget=function(e){const t=e();return t.EventTarget?new t.EventTarget:t.document.createElement("div")}(this._win)}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,e.clearTimeout(this._initTimer),this._initTimer=void 0,Object.keys(this._roots).forEach((e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])})),this.rootById={}}createRoot(e,t,s){const i=new Z(this._tabster,e,this._onRootDispose,t,s);return this._roots[i.id]=i,this._forceDummy&&i.addDummyInputs(),i}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const s=e().__tabsterInstance;return s&&s.root.rootById[t]}static getTabsterContext(e,t,s){var i,o,r,n;if(void 0===s&&(s={}),!t.ownerDocument)return;const l=s.checkRtl;let a,u,d,c,h,_,m,f,v=!1,b=t;const p={};for(;b&&(!a||l);){const s=T(e,b);if(l&&void 0===m){const e=b.dir;e&&(m="rtl"===e.toLowerCase())}if(!s){b=b.parentElement;continue}const n=b.tagName;(s.uncontrolled||"IFRAME"===n||"WEBVIEW"===n)&&(f=b),c||!(null===(i=s.focusable)||void 0===i?void 0:i.excludeFromMover)||d||(v=!0);const g=s.modalizer,E=s.groupper,y=s.mover;!u&&g&&(u=g),d||!E||u&&!g||(u?(!E.isActive()&&E.getProps().tabbability&&u.userId!==(null===(o=e.modalizer)||void 0===o?void 0:o.activeId)&&(u=void 0,d=E),_=E):d=E),c||!y||u&&!g||E&&b===t||(c=y,h=!!d&&d!==E),s.root&&(a=s.root),(null===(r=s.focusable)||void 0===r?void 0:r.ignoreKeydown)&&Object.assign(p,s.focusable.ignoreKeydown),b=b.parentElement}if(!a){const s=e.root;s._autoRoot&&(null===(n=t.ownerDocument)||void 0===n?void 0:n.body)&&(a=s._autoRootCreate())}d&&!c&&(h=!0);return a?{root:a,modalizer:u,groupper:d,mover:c,isGroupperFirst:h,modalizerInGroupper:_,isRtl:l?!!m:void 0,uncontrolled:f,isExcludedFromMover:v,ignoreKeydown:e=>!!p[e.key]}:void 0}static getRoot(e,t){var s;for(let i=t;i;i=i.parentElement){const t=null===(s=T(e,i))||void 0===s?void 0:s.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class te{}class se extends te{constructor(e,t){super(),this.uid=t.uid,this._tabster=e,this._deloser=t}belongsTo(e){return e===this._deloser}unshift(e){this._deloser.unshift(e)}async focusAvailable(){const e=this._deloser.findAvailable();return!!e&&this._tabster.focusedElement.focus(e)}async resetFocus(){return W(this._tabster.getWindow).resolve(this._deloser.resetFocus())}}class ie{constructor(e,t){this._history=[],this._tabster=e,this.rootUId=t}getLength(){return this._history.length}removeDeloser(e){this._history=this._history.filter((t=>!t.belongsTo(e)))}hasDeloser(e){return this._history.some((t=>t.belongsTo(e)))}}class oe extends ie{unshiftToDeloser(e,t){let s;for(let i=0;i<this._history.length;i++)if(this._history[i].belongsTo(e)){s=this._history[i],this._history.splice(i,1);break}s||(s=new se(this._tabster,e)),s.unshift(t),this._history.unshift(s),this._history.splice(10,this._history.length-10)}async focusAvailable(e){let t=!!e;for(const s of this._history)if(e&&s.belongsTo(e)&&(t=!1),!t&&await s.focusAvailable())return!0;return!1}async resetFocus(e){let t=!!e;const s={};for(const i of this._history)e&&i.belongsTo(e)&&(t=!1),t||s[i.uid]||(s[i.uid]=i);for(const i of Object.keys(s))if(await s[i].resetFocus())return!0;return!1}}class re{constructor(e){this._history=[],this._tabster=e}dispose(){this._history=[]}process(e){var t;const s=ee.getTabsterContext(this._tabster,e),i=s&&s.root.uid,o=ae.getDeloser(this._tabster,e);if(!i||!o)return;const r=this.make(i,(()=>new oe(this._tabster,i)));return s&&s.modalizer&&!(null===(t=s.modalizer)||void 0===t?void 0:t.isActive())||r.unshiftToDeloser(o,e),o}make(e,t){let s;for(let i=0;i<this._history.length;i++){const t=this._history[i];if(t.rootUId===e){s=t,this._history.splice(i,1);break}}return s||(s=t()),this._history.unshift(s),this._history.splice(10,this._history.length-10),s}removeDeloser(e){this._history.forEach((t=>{t.removeDeloser(e)})),this._history=this._history.filter((e=>e.getLength()>0))}async focusAvailable(e){let t=!!e;for(const s of this._history)if(e&&s.hasDeloser(e)&&(t=!1),!t&&await s.focusAvailable(e))return!0;return!1}async resetFocus(e){let t=!!e;for(const s of this._history)if(e&&s.hasDeloser(e)&&(t=!1),!t&&await s.resetFocus(e))return!0;return!1}}function ne(e,t,s){const i=[],o=/(:|\.|\[|\]|,|=|@)/g;e.id&&i.push("#"+e.id.replace(o,"\\$1")),!1!==t&&e.className&&e.className.split(" ").forEach((e=>{(e=e.trim())&&i.push("."+e.replace(o,"\\$1"))}));let r,n=0;if(!1!==s&&0===i.length){for(r=e;r;)n++,r=r.previousElementSibling;i.unshift(":nth-child("+n+")")}return i.unshift(e.tagName.toLowerCase()),i.join("")}class le extends L{constructor(e,t,s,i){super(e,t,i),this._isActive=!1,this._history=[[]],this._snapshotIndex=0,this.isActive=()=>this._isActive,this.setSnapshot=e=>{this._snapshotIndex=e,this._history.length>e+1&&this._history.splice(e+1,this._history.length-e-1),this._history[e]||(this._history[e]=[])},this.focusFirst=()=>{const e=this._element.get();return!!e&&this._tabster.focusedElement.focusFirst({container:e})},this.focusDefault=()=>{const e=this._element.get();return!!e&&this._tabster.focusedElement.focusDefault(e)},this.resetFocus=()=>{const e=this._element.get();return!!e&&this._tabster.focusedElement.resetFocus(e)},this.clearHistory=e=>{const t=this._element.get();this._history[this._snapshotIndex]=t?this._history[this._snapshotIndex].filter((s=>{const i=s.get();return!(!i||!e)&&t.contains(i)})):[]},this.uid=N(e.getWindow,t),this._onDispose=s}dispose(){this._remove(),this._onDispose(this),this._isActive=!1,this._snapshotIndex=0,this._props={},this._history=[]}setActive(e){this._isActive=e}getActions(){return{focusDefault:this.focusDefault,focusFirst:this.focusFirst,resetFocus:this.resetFocus,clearHistory:this.clearHistory,setSnapshot:this.setSnapshot,isActive:this.isActive}}unshift(e){let t=this._history[this._snapshotIndex];for(t=this._history[this._snapshotIndex]=t.filter((t=>{const s=t.get();return s&&s!==e})),t.unshift(new I(this._tabster.getWindow,e,function(e){if(!z(e.ownerDocument,e))return;const t=[ne(e)];let s=e.parentElement;for(;s;){const e="BODY"===s.tagName;if(t.unshift(ne(s,!1,!e)),e)break;s=s.parentElement}return t.join(" ")}(e)));t.length>10;)t.pop()}findAvailable(){const e=this._element.get();if(!e||!this._tabster.focusable.isVisible(e))return null;let t=this._props.restoreFocusOrder,s=null;const i=ee.getTabsterContext(this._tabster,e);if(!i)return null;const o=i.root,r=o.getElement();if(!r)return null;if(void 0===t&&(t=o.getProps().restoreFocusOrder),t===m.RootDefault&&(s=this._tabster.focusable.findDefault({container:r})),s||t!==m.RootFirst||(s=this._findFirst(r)),s)return s;const n=this._findInHistory(),l=this._tabster.focusable.findDefault({container:e}),a=this._findFirst(e);return n&&t===m.History?n:l&&t===m.DeloserDefault?l:a&&t===m.DeloserFirst?a:l||n||a||null}customFocusLostHandler(e){return $(e,n,this.getActions())}_findInHistory(){const e=this._history[this._snapshotIndex].slice(0);this.clearHistory(!0);for(let t=0;t<e.length;t++){const s=e[t],i=s.get(),o=this._element.get();if(i&&o&&o.contains(i)){if(this._tabster.focusable.isFocusable(i))return i}else if(!this._props.noSelectorCheck){const e=s.getData();if(e&&o){let t;try{t=o.ownerDocument.querySelectorAll(e)}catch(ze){0;continue}for(let e=0;e<t.length;e++){const s=t[e];if(s&&this._tabster.focusable.isFocusable(s))return s}}}}return null}_findFirst(e){if(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()){const t=this._tabster.focusable.findFirst({container:e,ignoreUncontrolled:!0,useActiveModalizer:!0});if(t)return t}return null}_remove(){0}}class ae{constructor(e,t){this._inDeloser=!1,this._isRestoringFocus=!1,this._isPaused=!1,this._init=()=>{this._initTimer=void 0,this._tabster.focusedElement.subscribe(this._onFocus)},this._onFocus=e=>{if(this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),!e)return void this._scheduleRestoreFocus();const t=this._history.process(e);t?this._activate(t):this._deactivate()},this._onDeloserDispose=e=>{this._history.removeDeloser(e),e.isActive()&&this._scheduleRestoreFocus()},this._tabster=e,this._win=e.getWindow,this._history=new re(e),this._initTimer=this._win().setTimeout(this._init,0);const s=null===t||void 0===t?void 0:t.autoDeloser;s&&(this._autoDeloser=s)}dispose(){const e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._restoreFocusTimer&&(e.clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),this._autoDeloserInstance&&(this._autoDeloserInstance.dispose(),delete this._autoDeloserInstance,delete this._autoDeloser),this._tabster.focusedElement.unsubscribe(this._onFocus),this._history.dispose(),delete this._curDeloser}createDeloser(e,t){var s;const i=new le(this._tabster,e,this._onDeloserDispose,t);return e.contains(null!==(s=this._tabster.focusedElement.getFocusedElement())&&void 0!==s?s:null)&&this._activate(i),i}getActions(e){for(let t=e;t;t=t.parentElement){const e=T(this._tabster,t);if(e&&e.deloser)return e.deloser.getActions()}}pause(){this._isPaused=!0,this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0)}resume(e){this._isPaused=!1,e&&this._scheduleRestoreFocus()}_activate(e){const t=this._curDeloser;t!==e&&(this._inDeloser=!0,null===t||void 0===t||t.setActive(!1),e.setActive(!0),this._curDeloser=e)}_deactivate(){var e;this._inDeloser=!1,null===(e=this._curDeloser)||void 0===e||e.setActive(!1),this._curDeloser=void 0}_scheduleRestoreFocus(e){if(this._isPaused||this._isRestoringFocus)return;const t=async()=>{this._restoreFocusTimer=void 0;const t=this._tabster.focusedElement.getLastFocusedElement();if(!e&&(this._isRestoringFocus||!this._inDeloser||(null===t||void 0===t?void 0:t.offsetParent)))return;const s=this._curDeloser;if(s){if(t&&s.customFocusLostHandler(t))return;const e=s.findAvailable();if(e&&this._tabster.focusedElement.focus(e))return}this._deactivate(),this._isRestoringFocus=!0,await this._history.focusAvailable(null)||await this._history.resetFocus(null),this._isRestoringFocus=!1};e?t():this._restoreFocusTimer=this._win().setTimeout(t,100)}static getDeloser(e,t){var s;let i;for(let r=t;r;r=r.parentElement){const t=T(e,r);if(t){i||(i=t.root);const e=t.deloser;if(e)return e}}const o=e.deloser&&e.deloser;if(o){if(o._autoDeloserInstance)return o._autoDeloserInstance;const r=o._autoDeloser;if(i&&!o._autoDeloserInstance&&r){const i=null===(s=t.ownerDocument)||void 0===s?void 0:s.body;i&&(o._autoDeloserInstance=new le(e,i,e.deloser._onDeloserDispose,r))}return o._autoDeloserInstance}}static getHistory(e){return e._history}static forceRestoreFocus(e){e._scheduleRestoreFocus(!0)}}class ue{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,s=t.indexOf(e);s>=0&&t.splice(s,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach((s=>s(e,t)))}}const de=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]"].join(", ");class ce{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=T(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,s,i){return!(!M(e,de)||!t&&-1===e.tabIndex)&&((s||this.isVisible(e))&&(i||this.isAccessible(e)))}isVisible(e){if(!e.ownerDocument)return!1;if(null===e.offsetParent&&e.ownerDocument.body!==e)return!1;const t=e.ownerDocument.defaultView;if(!t)return!1;const s=e.ownerDocument.body.getBoundingClientRect();if(0===s.width&&0===s.height)return!1;return"hidden"!==t.getComputedStyle(e).visibility}isAccessible(e){var t;for(let s=e;s;s=s.parentElement){const e=T(this._tabster,s);if(this._isHidden(s))return!1;if(!(null===(t=null===e||void 0===e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(s))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const s=e.getAttribute("aria-hidden");return!(!s||"true"!==s.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e){return this.findElement({...e})}findLast(e){return this.findElement({isBackward:!0,...e})}findNext(e){return this.findElement({...e})}findPrev(e){return this.findElement({isBackward:!0,...e})}findDefault(e){return this.findElement({...e,acceptCondition:t=>this._tabster.focusable.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault})||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e){const t=this._findElements(!1,e);return t?t[0]:t}_findElements(e,t){var s,i,o;const{container:r,currentElement:n=null,includeProgrammaticallyFocusable:l,useActiveModalizer:a,ignoreUncontrolled:u,ignoreAccessibility:d,modalizerId:c,isBackward:h,onUncontrolled:_,onElement:m}=t,f=[];let{acceptCondition:v}=t;if(!r)return null;v||(v=e=>this._tabster.focusable.isFocusable(e,l,!1,d));const b={container:r,modalizerUserId:void 0===c&&a?null===(s=this._tabster.modalizer)||void 0===s?void 0:s.activeId:c||(null===(o=null===(i=ee.getTabsterContext(this._tabster,r))||void 0===i?void 0:i.modalizer)||void 0===o?void 0:o.userId),from:n||r,isBackward:h,acceptCondition:v,includeProgrammaticallyFocusable:l,ignoreUncontrolled:u,ignoreAccessibility:d,cachedGrouppers:{}},p=O(r.ownerDocument,r,(e=>this._acceptElement(e,b)));if(!p)return null;const g=t=>{const s=b.foundElement;return s&&f.push(s),e?!(s&&(b.found=!1,delete b.foundElement,delete b.fromCtx,b.from=s,m&&!m(s)))&&!(!s&&!t):!(!t||s)};if(n)p.currentNode=n;else if(h){const e=H(r);if(!e)return null;if(this._acceptElement(e,b)===NodeFilter.FILTER_ACCEPT&&!g(!0))return f;p.currentNode=e}let T;do{T=(h?p.previousNode():p.nextNode())||void 0}while(g());if(!e){const e=b.nextUncontrolled;if(e)return _&&_(e),T?void 0:null}return f.length?f:null}_acceptElement(e,t){var s,i,o,r,n;if(t.found)return NodeFilter.FILTER_ACCEPT;const l=t.container;if(e===l)return NodeFilter.FILTER_SKIP;if(!l.contains(e))return NodeFilter.FILTER_REJECT;if(e.__tabsterDummyContainer)return NodeFilter.FILTER_REJECT;let a=t.lastToIgnore;if(a){if(a.contains(e))return NodeFilter.FILTER_REJECT;a=t.lastToIgnore=void 0}const u=t.currentCtx=ee.getTabsterContext(this._tabster,e);if(!u)return NodeFilter.FILTER_SKIP;if(t.ignoreUncontrolled){if(R(e))return NodeFilter.FILTER_SKIP}else if(u.uncontrolled&&!t.nextUncontrolled&&this._tabster.focusable.isFocusable(e,void 0,!0,!0)&&!u.groupper&&!u.mover&&(null===(s=u.modalizer)||void 0===s?void 0:s.userId)===(null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId))return this.isVisible(u.uncontrolled)&&(t.nextUncontrolled=u.uncontrolled),NodeFilter.FILTER_REJECT;if("IFRAME"===e.tagName||"WEBVIEW"===e.tagName)return(null===(o=u.modalizer)||void 0===o?void 0:o.userId)===(null===(r=this._tabster.modalizer)||void 0===r?void 0:r.activeId)?(t.found=!0,t.lastToIgnore=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return NodeFilter.FILTER_REJECT;let d,c=t.fromCtx;c||(c=t.fromCtx=ee.getTabsterContext(this._tabster,t.from));const h=null===c||void 0===c?void 0:c.mover;let _=u.groupper,m=u.mover;if(d=null===(n=this._tabster.modalizer)||void 0===n?void 0:n.acceptElement(e,t),void 0===d&&(_||m||h)){const s=null===_||void 0===_?void 0:_.getElement(),i=null===h||void 0===h?void 0:h.getElement();let o=null===m||void 0===m?void 0:m.getElement();o&&i&&l.contains(i)&&(!s||!m||i.contains(s))&&(m=h,o=i),!s||s!==l&&l.contains(s)||(_=void 0),o&&!l.contains(o)&&(m=void 0),_&&m&&(o&&s&&!s.contains(o)?m=void 0:_=void 0),_&&(d=_.acceptElement(e,t)),m&&(d=m.acceptElement(e,t))}return void 0===d&&(d=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),d!==NodeFilter.FILTER_ACCEPT||t.found||(t.found=!0,t.foundElement=e),d}}const he=9,_e=13,me=27;class fe extends ue{constructor(e,t){super(),this._init=()=>{this._initTimer=void 0;const e=this._win(),t=e.document;t.addEventListener(i.PW,this._onFocusIn,!0),t.addEventListener("focusout",this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const s=t.activeElement;s&&s!==t.body&&this._setFocusedElement(s),this.subscribe(this._onChanged)},this._onFocusIn=e=>{this._setFocusedElement(e.target,e.details.relatedTarget,e.details.isFocusedProgrammatically)},this._onFocusOut=e=>{this._setFocusedElement(void 0,e.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{var t,s,o,r,n,l;if(e.keyCode!==he||e.ctrlKey)return;const a=this.getVal();if(!a||!a.ownerDocument||"true"===a.contentEditable)return;const d=this._tabster,c=d.controlTab,h=ee.getTabsterContext(d,a);if(!h||h.ignoreKeydown(e))return;const _=e.shiftKey,m=fe.findNextTabbable(d,h,void 0,a,_,void 0,!0);let f;if(m){let e=m.uncontrolled;if(e){const i=h.isGroupperFirst;let o=!1;if(void 0!==i){const r=null===(t=h.groupper)||void 0===t?void 0:t.getElement(),n=null===(s=h.mover)||void 0===s?void 0:s.getElement();let l;i&&r&&e.contains(r)?l=r:!i&&n&&e.contains(n)&&(l=n),l&&(e=l,o=!0)}return void(e&&h.uncontrolled!==e&&K.moveWithPhantomDummy(this._tabster,e,o,_))}f=m.element}if(f){const t=()=>{e.preventDefault(),e.stopImmediatePropagation()};if(c)"IFRAME"!==f.tagName&&(t(),(0,i.ev)(f));else{const e=null===m||void 0===m?void 0:m.lastMoverOrGroupper;let s=null===m||void 0===m?void 0:m.outOfDOMOrder;if(!s&&a.compareDocumentPosition(f)&(_?document.DOCUMENT_POSITION_FOLLOWING:document.DOCUMENT_POSITION_PRECEDING)&&(s=!0),s)t(),(0,i.ev)(f);else if(e)null===(o=e.dummyManager)||void 0===o||o.moveOutWithDefaultAction(_);else if(h.modalizer){const e=ee.getTabsterContext(d,f);e&&h.root.uid===e.root.uid&&(null===(r=e.modalizer)||void 0===r?void 0:r.isActive())||!h.modalizer.triggerFocusEvent(u,!0)?(null===(n=h.modalizer.getElement())||void 0===n?void 0:n.contains(f))||(t(),null===(l=h.modalizer.dummyManager)||void 0===l||l.moveOut(_)):t()}}}else h.root.moveOutWithDefaultAction(_)},this._onChanged=(e,t)=>{var s,i;if(e)$(e,c,t);else{const e=null===(s=this._lastVal)||void 0===s?void 0:s.get();if(e){const s={...t},o=ee.getTabsterContext(this._tabster,e),r=null===(i=null===o||void 0===o?void 0:o.modalizer)||void 0===i?void 0:i.userId;r&&(s.modalizerId=r),$(e,h,s)}}},this._tabster=e,this._win=t,this._initTimer=t().setTimeout(this._init,0)}dispose(){super.dispose();const e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),e.document.removeEventListener(i.PW,this._onFocusIn,!0),e.document.removeEventListener("focusout",this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged),delete fe._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var s,i;let o=fe._lastResetElement,r=o&&o.get();r&&t.contains(r)&&delete fe._lastResetElement,r=null===(i=null===(s=e._nextVal)||void 0===s?void 0:s.element)||void 0===i?void 0:i.get(),r&&t.contains(r)&&delete e._nextVal,o=e._lastVal,r=o&&o.get(),r&&t.contains(r)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!z(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,s){return!!this._tabster.focusable.isFocusable(e,t,!1,s)&&(e.focus(),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){const s=this._tabster.focusable,{container:i,ignoreAccessibility:o}=t;let r,n;if(i){const t=ee.getTabsterContext(this._tabster,i);if(t){let l=fe.findNextTabbable(this._tabster,t,i,void 0,!e,void 0,o);if(l)for(n=l.element,r=l.uncontrolled;!n&&r;)n=s.isFocusable(r,!1,!0,!0)?r:s[e?"findFirst":"findLast"]({container:r,ignoreUncontrolled:!0,ignoreAccessibility:o,useActiveModalizer:!0}),n||(l=fe.findNextTabbable(this._tabster,t,r,void 0,!e,void 0,o),l&&(n=l.element,r=l.uncontrolled))}}return n&&!(null===i||void 0===i?void 0:i.contains(n))&&(n=void 0),n||void 0}_focusFirstOrLast(e,t){const s=this.getFirstOrLastTabbable(e,t);return!!s&&(this.focus(s,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),s=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),fe._lastResetElement=new I(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",s)}return!0}_setOrRemoveAttribute(e,t,s){null===s?e.removeAttribute(t):e.setAttribute(t,s)}_setFocusedElement(e,t,s){var i,o;if(this._tabster._noop)return;const r={relatedTarget:t};if(e){const t=null===(i=fe._lastResetElement)||void 0===i?void 0:i.get();if(fe._lastResetElement=void 0,t===e||R(e))return;r.isFocusedProgrammatically=s;const n=ee.getTabsterContext(this._tabster,e),l=null===(o=null===n||void 0===n?void 0:n.modalizer)||void 0===o?void 0:o.userId;l&&(r.modalizerId=l)}const n=this._nextVal={element:e?new I(this._win,e):void 0,details:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===n&&this.setVal(e,r),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new I(this._win,e))}static findNextTabbable(e,t,s,i,o,r,n){const l=s||t.root.getElement();if(!l)return null;let a=null;const u=fe._isTabbingTimer,d=e.getWindow();u&&d.clearTimeout(u),fe.isTabbing=!0,fe._isTabbingTimer=d.setTimeout((()=>{delete fe._isTabbingTimer,fe.isTabbing=!1}),0);const c=(t,s)=>{a=t.findNextTabbable(s||i,o,r,n);const l=null===a||void 0===a?void 0:a.lastMoverOrGroupper;if(l&&!(null===a||void 0===a?void 0:a.element)&&!(null===a||void 0===a?void 0:a.uncontrolled)){const t=l.getElement(),s=null===t||void 0===t?void 0:t.parentElement,i=s&&ee.getTabsterContext(e,s);if(i){const e=i.isGroupperFirst?i.groupper:i.mover;if(e){const s=o?t:H(t);c(e,s),a&&(a.outOfDOMOrder=!0)}}}},h=t.modalizer,_=t.groupper,m=t.mover;if(_&&m)c(t.isGroupperFirst?_:m);else if(_)c(_);else if(m)c(m);else if(h)c(h);else{let t;const s=e=>{t=e},u=o?e.focusable.findPrev({container:l,currentElement:i,onUncontrolled:s,ignoreUncontrolled:r,ignoreAccessibility:n,useActiveModalizer:!0}):e.focusable.findNext({container:l,currentElement:i,onUncontrolled:s,ignoreUncontrolled:r,ignoreAccessibility:n,useActiveModalizer:!0});a={element:t?void 0:u,uncontrolled:t}}const f=null===a||void 0===a?void 0:a.lastMoverOrGroupper,v=null===f||void 0===f?void 0:f.getElement();if(v){a=null;const t=J(v,o);if(t){const s=ee.getTabsterContext(e,t,{checkRtl:!0});if(s){let i=J(t,!o);i&&(o||(i=H(i)||i),a=fe.findNextTabbable(e,s,l,i,o,r,n),a&&!a.lastMoverOrGroupper&&(a.lastMoverOrGroupper=f))}}}return a}}fe.isTabbing=!1;class ve extends K{constructor(e,t,s,o){super(s,e,B,o,!0),this._setHandlers(((o,r,n)=>{var l,a;const u=e.get(),d=o.input;if(u&&d){const e=ee.getTabsterContext(s,d);if(e){let c;c=null===(l=t.findNextTabbable(n||void 0,r,!0,!0))||void 0===l?void 0:l.element,c||(c=null===(a=fe.findNextTabbable(s,e,void 0,o.isOutside?d:J(u,!r),r,!0,!0))||void 0===a?void 0:a.element),c&&(0,i.ev)(c)}}}))}}class be extends L{constructor(e,t,s,i,o){super(e,t,i),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=s,e.controlTab||(this.dummyManager=new ve(this._element,this,e,o))}dispose(){var e;this._onDispose(this);this._element.get();null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this._first}findNextTabbable(e,t,s,i){var o;const r=this.getElement();if(!r)return null;const n=(null===(o=null===e||void 0===e?void 0:e.__tabsterDummyContainer)||void 0===o?void 0:o.get())===r;if(!this._shouldTabInside&&e&&r.contains(e)&&!n)return{element:void 0,lastMoverOrGroupper:this};const l=this.getFirst(!0);if(!e||!r.contains(e)||n)return{element:l,lastMoverOrGroupper:l?void 0:this};const a=this._tabster;let u,d=null;const c=e=>{u=e};return this._shouldTabInside&&l&&(d=t?a.focusable.findPrev({container:r,currentElement:e,onUncontrolled:c,ignoreUncontrolled:s,ignoreAccessibility:i,useActiveModalizer:!0}):a.focusable.findNext({container:r,currentElement:e,onUncontrolled:c,ignoreUncontrolled:s,ignoreAccessibility:i,useActiveModalizer:!0}),u||d||this._props.tabbability!==b.LimitedTrapFocus||(d=t?a.focusable.findLast({container:r,ignoreUncontrolled:!0,ignoreAccessibility:i,useActiveModalizer:!0}):a.focusable.findFirst({container:r,ignoreUncontrolled:!0,ignoreAccessibility:i,useActiveModalizer:!0}))),{element:d,uncontrolled:u,lastMoverOrGroupper:d||u?void 0:this}}makeTabbable(e){this._shouldTabInside=e||!this._props.tabbability}isActive(e){var t;const s=this.getElement()||null;let i=!0;for(let r=null===s||void 0===s?void 0:s.parentElement;r;r=r.parentElement){const e=null===(t=T(this._tabster,r))||void 0===t?void 0:t.groupper;e&&(e._shouldTabInside||(i=!1))}let o=i?!!this._props.tabbability&&this._shouldTabInside:void 0;if(o&&e){const e=this._tabster.focusedElement.getFocusedElement();e&&(o=e!==this.getFirst(!0))}return o}getFirst(e){var t;const s=this.getElement();let i;if(s){if(e&&this._tabster.focusable.isFocusable(s))return s;i=null===(t=this._first)||void 0===t?void 0:t.get(),i||(i=this._tabster.focusable.findFirst({container:s,ignoreUncontrolled:!0,useActiveModalizer:!0})||void 0,i&&this.setFirst(i))}return i}setFirst(e){e?this._first=new I(this._tabster.getWindow,e):delete this._first}acceptElement(e,t){var s;const i=t.cachedGrouppers,o=null===(s=this.getElement())||void 0===s?void 0:s.parentElement,r=o&&ee.getTabsterContext(this._tabster,o),n=null===r||void 0===r?void 0:r.groupper,l=(null===r||void 0===r?void 0:r.isGroupperFirst)?n:void 0;let a;const u=e=>{let t,s=i[e.id];return s?t=s.isActive:(t=this.isActive(!0),s=i[e.id]={isActive:t}),t};if(l&&(a=l.getElement(),!u(l)&&a&&t.container!==a&&t.container.contains(a)))return NodeFilter.FILTER_REJECT;const d=u(this),c=this.getElement();if(c&&!0!==d){if(c===e&&n&&(a||(a=n.getElement()),a&&!u(n)&&t.container.contains(a)&&a!==t.container))return NodeFilter.FILTER_REJECT;if(c!==e&&c.contains(e))return NodeFilter.FILTER_REJECT;const s=i[this.id];let o;if(o="first"in s?s.first:s.first=this.getFirst(!0),o&&t.acceptCondition(o))return t.lastToIgnore=c,o!==t.from?(t.found=!0,t.foundElement=o,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class pe{constructor(e,t){this._current={},this._grouppers={},this._init=()=>{this._initTimer=void 0;const e=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus),e.document.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0)},this._onGroupperDispose=e=>{delete this._grouppers[e.id]},this._onFocus=e=>{e&&this._updateCurrent(e,!0,!0)},this._onMouseDown=e=>{e.target&&this._updateCurrent(e.target,!0)},this._onKeyDown=e=>{if(e.keyCode!==_e&&e.keyCode!==me)return;const t=this._tabster.focusedElement.getFocusedElement();t&&this.handleKeyPress(t,e)},this._tabster=e,this._win=t,this._initTimer=t().setTimeout(this._init,0)}dispose(){const e=this._win();this._current={},this._initTimer&&(e.clearTimeout(this._initTimer),delete this._initTimer),this._updateTimer&&(e.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._grouppers).forEach((e=>{this._grouppers[e]&&(this._grouppers[e].dispose(),delete this._grouppers[e])}))}createGroupper(e,t,s){const i=new be(this._tabster,e,this._onGroupperDispose,t,s);this._grouppers[i.id]=i;const o=this._tabster.focusedElement.getFocusedElement();return o&&e.contains(o)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout((()=>{delete this._updateTimer,o===this._tabster.focusedElement.getFocusedElement()&&this._updateCurrent(o,!0,!0)}),0)),i}forgetCurrentGrouppers(){this._current={}}_updateCurrent(e,t,s){var i;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);const o={};let r=!0;for(let n=e;n;n=n.parentElement){const l=null===(i=T(this._tabster,n))||void 0===i?void 0:i.groupper;if(l){if(o[l.id]=!0,r&&s&&n!==e&&(r=!1),t||!r){this._current[l.id]=l;const t=l.isActive()||e!==n&&(!l.getProps().delegated||l.getFirst(!1)!==e);l.makeTabbable(t)}r=!1}}for(const n of Object.keys(this._current)){const e=this._current[n];e.id in o||(e.makeTabbable(!1),e.setFirst(void 0),delete this._current[n])}}handleKeyPress(e,t,s){var i;const o=this._tabster,r=ee.getTabsterContext(o,e),n=null===r||void 0===r?void 0:r.modalizerInGroupper;let l=(null===r||void 0===r?void 0:r.groupper)||n;if(r&&l){if(r.ignoreKeydown(t))return;let a;const u=l.getElement();if(t.keyCode===_e)u&&(e===u||l.getProps().delegated&&e===l.getFirst(!1))&&(a=o.focusable.findNext({container:u,currentElement:e,useActiveModalizer:!0}));else if(t.keyCode===me){if(u&&u.contains(e))if(e!==u||s)a=l.getFirst(!0);else{const e=u.parentElement,t=e?ee.getTabsterContext(o,e):void 0;l=null===t||void 0===t?void 0:t.groupper,a=null===l||void 0===l?void 0:l.getFirst(!0)}l&&(l.makeTabbable(!1),n&&(null===(i=o.modalizer)||void 0===i||i.setActive(void 0)))}a&&(t.preventDefault(),t.stopImmediatePropagation(),a.focus())}}}class ge extends ue{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,i.Vm)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,i.ub)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let Te=0;const Ee="aria-hidden";class ye extends K{constructor(e,t,s){super(t,e,V,s),this._setHandlers(((s,o)=>{var r,n,l;const a=e.get(),u=a&&(null===(r=ee.getRoot(t,a))||void 0===r?void 0:r.getElement()),d=s.input;let c;if(u&&d){const e=null===(n=d.__tabsterDummyContainer)||void 0===n?void 0:n.get(),s=ee.getTabsterContext(t,e||d);s&&(c=null===(l=fe.findNextTabbable(t,s,u,d,o,!0,!0))||void 0===l?void 0:l.element),c&&(0,i.ev)(c)}}))}}class Fe extends L{constructor(e,t,s,i,o,r){super(e,t,i),this._wasFocused=0,this.userId=i.id,this._onDispose=s,this._activeElements=r,e.controlTab||(this.dummyManager=new ye(this._element,e,o))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const s=this._activeElements,i=s.map((e=>e.deref())).indexOf(t);e?i<0&&s.push(new WeakRef(t)):i>=0&&s.splice(i,1)}0,this.triggerFocusEvent(e?l:a)}}focused(e){return e||(this._wasFocused=++Te),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){var t;return!!(null===(t=this.getElement())||void 0===t?void 0:t.contains(e))}findNextTabbable(e,t,s,i){var o,r;if(!this.getElement())return null;const n=this._tabster;let l,a=null;const u=e=>{l=e},d=e&&(null===(o=ee.getRoot(n,e))||void 0===o?void 0:o.getElement());return d&&(a=n.focusable[t?"findPrev":"findNext"]({container:d,currentElement:e,onUncontrolled:u,ignoreUncontrolled:s,ignoreAccessibility:i,useActiveModalizer:!0}),!l&&!a&&this._props.isTrapped&&(null===(r=n.modalizer)||void 0===r?void 0:r.activeId)&&(a=n.focusable[t?"findLast":"findFirst"]({container:d,ignoreUncontrolled:!0,ignoreAccessibility:i,useActiveModalizer:!0}))),{element:a,uncontrolled:l}}triggerFocusEvent(e,t){const s=this.getElement();let i=!1;if(s){const o=t?this._activeElements.map((e=>e.deref())):[s];for(const t of o)t&&!$(t,e,{id:this.userId,element:s,eventName:e})&&(i=!0)}return i}_remove(){0}}class we{constructor(e){this._init=()=>{this._initTimer=void 0,this._tabster.focusedElement.subscribe(this._onFocus)},this._onModalizerDispose=e=>{const t=e.id,s=e.userId,i=this._parts[s];delete this._modalizers[t],i&&(delete i[t],0===Object.keys(i).length&&(delete this._parts[s],this.activeId===s&&this.setActive(void 0)))},this._onKeyDown=e=>{var t;if(e.keyCode!==me)return;const s=this._tabster,i=s.focusedElement.getFocusedElement();if(i){const o=ee.getTabsterContext(s,i),r=null===o||void 0===o?void 0:o.modalizer;if(o&&!o.groupper&&(null===r||void 0===r?void 0:r.isActive())&&!o.ignoreKeydown(e)){const i=r.userId;if(i){const o=this._parts[i];if(o){const i=Object.keys(o).map((e=>{var t;const s=o[e],i=s.getElement();let r;return i&&(r=null===(t=T(this._tabster,i))||void 0===t?void 0:t.groupper),s&&i&&r?{el:i,focusedSince:s.focused(!0)}:{focusedSince:0}})).filter((e=>e.focusedSince>0)).sort(((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0));if(i.length){const o=i[0].el;o&&(null===(t=s.groupper)||void 0===t||t.handleKeyPress(o,e,!0))}}}}}},this._onFocus=(e,t)=>{var s,i;const o=e&&ee.getTabsterContext(this._tabster,e);if(!o||!e)return;const r=this._augMap;for(let l=e;l;l=l.parentElement)r.has(l)&&(r.delete(l),Q(this._tabster,l,Ee));const n=o.modalizer;if(null===(i=n||(null===(s=T(this._tabster,e))||void 0===s?void 0:s.modalizer))||void 0===i||i.focused(),(null===n||void 0===n?void 0:n.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null===n||void 0===n?void 0:n.getProps().isAlwaysAccessible))this.setActive(n);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout((()=>this._restoreModalizerFocus(e)),100)}else this.currentIsOthersAccessible=null===n||void 0===n?void 0:n.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this.activeElements=[],e.controlTab||e.root.addDummyInputs();this._win().addEventListener("keydown",this._onKeyDown,!0)}dispose(){const e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach((e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])})),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,s){var i;const o=new Fe(this._tabster,e,this._onModalizerDispose,t,s,this.activeElements),r=o.id,n=t.id;this._modalizers[r]=o;let l=this._parts[n];return l||(l=this._parts[n]={}),l[r]=o,e.contains(null!==(i=this._tabster.focusedElement.getFocusedElement())&&void 0!==i?i:null)&&(n!==this.activeId?this.setActive(o):o.makeActive(!0)),o}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout((()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()}),250))}setActive(e){const t=null===e||void 0===e?void 0:e.userId,s=this.activeId;if(s!==t){if(this.activeId=t,s){const e=this._parts[s];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null===e||void 0===e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate()}}focus(e,t,s){const i=ee.getTabsterContext(this._tabster,e),o=null===i||void 0===i?void 0:i.modalizer;if(o){this.setActive(o);const e=o.getProps(),i=o.getElement();if(i){if(void 0===t&&(t=e.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:i}))return!0;if(void 0===s&&(s=e.isNoFocusDefault),!s&&this._tabster.focusedElement.focusDefault(i))return!0;this._tabster.focusedElement.resetFocus(i)}}else 0;return!1}acceptElement(e,t){var s;const i=t.modalizerUserId,o=null===(s=t.currentCtx)||void 0===s?void 0:s.modalizer;if(i)for(const r of this.activeElements){const t=r.deref();if(t&&(e.contains(t)||t===e))return NodeFilter.FILTER_SKIP}return i===(null===o||void 0===o?void 0:o.userId)||!i&&(null===o||void 0===o?void 0:o.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP}_hiddenUpdate(){var e;const t=this._tabster,s=t.getWindow().document.body,i=this.activeId,o=this._parts,r=[],n=[],l=[];for(const m of Object.keys(o)){const e=o[m];for(const t of Object.keys(e)){const s=e[t],o=s.getElement(),a=s.getProps().isAlwaysAccessible;o&&(m===i?this.currentIsOthersAccessible||r.push(o):a?l.push(o):n.push(o))}}const a=this._augMap,u=r.length>0?[...r,...l]:void 0,d=[],c=new WeakMap,h=(e,s)=>{const i=e.tagName;if("SCRIPT"===i||"STYLE"===i)return;let o=!1;a.has(e)?s?o=!0:(a.delete(e),Q(t,e,Ee)):s&&Q(t,e,Ee,"true")&&(a.set(e,!0),o=!0),o&&(d.push(new WeakRef(e)),c.set(e,!0))},_=e=>{for(let t=e.firstElementChild;t;t=t.nextElementSibling){let e=!1,s=!1;if(u){for(const i of u){if(t===i){e=!0;break}if(t.contains(i)){s=!0;break}}s?_(t):e||h(t,!0)}else h(t,!1)}};u||l.forEach((e=>h(e,!1))),n.forEach((e=>h(e,!0))),s&&_(s),null===(e=this._aug)||void 0===e||e.map((e=>e.deref())).forEach((e=>{e&&!c.get(e)&&h(e,!1)})),this._aug=d,this._augMap=c}_restoreModalizerFocus(e){const t=null===e||void 0===e?void 0:e.ownerDocument;if(!e||!t)return;const s=ee.getTabsterContext(this._tabster,e),i=null===s||void 0===s?void 0:s.modalizer,o=this.activeId;if(!i&&!o||i&&o===i.userId)return;const r=null===s||void 0===s?void 0:s.root.getElement();if(r){let t=this._tabster.focusable.findFirst({container:r,ignoreUncontrolled:!0,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=this._tabster.focusable.findLast({container:r,ignoreUncontrolled:!0,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void this._tabster.focusedElement.focus(t)}}e.blur()}}class De{constructor(){}}class Ie{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class ke{constructor(e,t){var s;this._forgetMemorizedElements=[],this._wrappers=new Set,this._version="4.2.0",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null===t||void 0===t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const i=this.getWindow;this.keyboardNavigation=new ge(i),this.focusedElement=new fe(this,i),this.focusable=new ce(this),this.root=new ee(this,null===t||void 0===t?void 0:t.autoRoot),this.uncontrolled=new De,this.controlTab=null===(s=null===t||void 0===t?void 0:t.controlTab)||void 0===s||s,this.rootDummyInputs=!!(null===t||void 0===t?void 0:t.rootDummyInputs),this._dummyObserver=new j(i),this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=i().document;this._unobserve=function(e,t,s,i){if("undefined"===typeof MutationObserver)return()=>{};const r=t.getWindow;let n;function l(t,s){n||(n=w(r).elementByUId),a(t,s);const i=O(e,t,(e=>a(e,s)));if(i)for(;i.nextNode(););}function a(e,i){var l;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const a=e.__tabsterElementUID;return a&&n&&(i?delete n[a]:null!==(l=n[a])&&void 0!==l||(n[a]=new I(r,e))),(T(t,e)||e.hasAttribute(o))&&s(t,e,i),NodeFilter.FILTER_SKIP}const u=new MutationObserver((e=>{var i,r,n,a,u;for(const d of e){const e=d.target,u=d.removedNodes,c=d.addedNodes;if("attributes"===d.type)d.attributeName===o&&s(t,e);else{for(let s=0;s<u.length;s++)l(u[s],!0),null===(r=(i=t._dummyObserver).domChanged)||void 0===r||r.call(i,e);for(let s=0;s<c.length;s++)l(c[s]),null===(a=(n=t._dummyObserver).domChanged)||void 0===a||a.call(n,e)}}null===(u=t.modalizer)||void 0===u||u.hiddenUpdate()}));return i&&l(r().document.body),u.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[o]}),()=>{u.disconnect()}}(t,this,E,e)}}},A(i),this._initTimer=e.setTimeout((()=>{delete this._initTimer,this.internal.resumeObserver(!0)}),0)}createTabster(e){const t=new Ie(this);return e||this._wrappers.add(t),t}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,s,i,o,r,n;this.internal.stopObserver();const l=this._win;null===l||void 0===l||l.clearTimeout(this._initTimer),delete this._initTimer,this._forgetMemorizedElements=[],l&&this._forgetMemorizedTimer&&(l.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(s=this.deloser)||void 0===s||s.dispose(),null===(i=this.groupper)||void 0===i||i.dispose(),null===(o=this.mover)||void 0===o||o.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(n=this.observedElement)||void 0===n||n.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=w(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),x(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),l&&(!function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(l),delete l.__tabsterInstance,delete this._win)}storageEntry(e,t){const s=this._storage;let i=s.get(e);return i?!1===t&&0===Object.keys(i).length&&s.delete(e):!0===t&&(i={},s.set(e,i)),i}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout((()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())x(this.getWindow,e),fe.forgetMemorized(this.focusedElement,e)}),0),k(this.getWindow,!0)))}}function Ae(e,t){let s=xe(e);return s||(s=new ke(e,t),e.__tabsterInstance=s),s.createTabster()}function Oe(e){const t=e.core;return t.groupper||(t.groupper=new pe(t,t.getWindow)),t.groupper}function Re(e,t){const s=e.core;return s.deloser||(s.deloser=new ae(s,t)),s.deloser}function Ce(e){const t=e.core;return t.modalizer||(t.modalizer=new we(t)),t.modalizer}function Ne(e,t){e.core.disposeTabster(e,t)}function xe(e){return e.__tabsterInstance}}}]);